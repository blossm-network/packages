domain: principle
service: core

schema:
  roles:
    - id: String
      service: String
      network: String
  contexts:
    - root: String
      service: String
      network: String

actions:
  - add-roles
  - remove-roles
  - add-contexts
  - remove-contexts

dependencies:
  "@blossm/array-difference": "*"

testing:
  examples:
    first:
      action: add-roles
      payload:
        roles:
          - id: some-role
            service: some-role-service
            network: some-role-network
          - id: some-other-role
            service: some-other-role-service
            network: some-other-role-network
    second:
      action: remove-roles
      payload:
        roles:
          - id: some-role
            service: some-role-service
            network: some-role-network
    more:
      - action: add-contexts
        payload:
          contexts:
            - root: some-context
              service: some-context-service
              network: some-context-network
      - action: remove-contexts
        payload:
          contexts:
            - root: some-context
              service: some-context-service
              network: some-context-network

  handlers:
    - action: add-roles
      examples:
        - state:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
          payload:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
              - id: some-other-role
                service: some-other-role-service
                network: some-other-role-network
          result:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
              - id: some-other-role
                service: some-other-role-service
                network: some-other-role-network
        - state: {}
          payload:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
          result:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
    - action: remove-roles
      examples:
        - state:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
              - id: some-other-role
                service: some-other-role-service
                network: some-other-role-network
          payload:
            roles:
              - id: some-role
                service: some-role-service
                network: some-role-network
          result:
            roles:
              - id: some-other-role
                service: some-other-role-service
                network: some-other-role-network
    - action: add-contexts
      examples:
        - state:
            contexts:
              - root: some-context
                service: some-context-service
                network: some-context-network
          payload:
            contexts:
              - root: some-context
                service: some-context-service
                network: some-context-network
              - root: some-other-context
                service: some-other-context-service
                network: some-other-context-network
          result:
            contexts:
              - root: some-context
                service: some-context-service
                network: some-context-network
              - root: some-other-context
                service: some-other-context-service
                network: some-other-context-network
    - action: remove-contexts
      examples:
        - state:
            contexts:
              - root: some-context
                service: some-context-service
                network: some-context-network
              - root: some-other-context
                service: some-other-context-service
                network: some-other-context-network
          payload:
            contexts:
              - root: some-context
                service: some-context-service
                network: some-context-network
          result:
            contexts:
              - root: some-other-context
                service: some-other-context-service
                network: some-other-context-network

#don't change
context: event-store
