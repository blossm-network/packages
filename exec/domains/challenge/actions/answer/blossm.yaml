action: answer
domain: challenge
version: 0

dependencies:
  "@blossm/validator": "*"
  "@blossm/duration-consts": "*"
  "@blossm/errors": "*"
  "@blossm/view-store-rpc": "*"
  "@blossm/gcp-token": "*"
  "@blossm/jwt": "*"
  "@blossm/gcp-kms": "*"

devDependencies:
  "localenv": "^0.2.2"
  "mocha": "^6.1.4"
  "chai": "^4.2.0"
  "sinon": "^7.3.2"
  "sinon-chai": "^3.3.0"
  "chai-datetime": "^1.5.0"
  "@blossm/datetime": "*"
  "@blossm/request": "*"
  "@blossm/event-store-rpc": "*"
  "@blossm/command-rpc": "*"
  "@blossm/twilio-sms": "*"
  "@blossm/gcp-secret": "*"
  "@blossm/uuid": "*"
  "@blossm/jwt": "*"
  "@blossm/gcp-kms": "*"
  "@blossm/gcp-pubsub": "*"
  "@blossm/get-token": "*"

service: core

#don't change
context: command-handler

testing:
  examples:
    - payload:
        code: "123456"
      normalized:
        code: "123456"

  invalid: bad

  root: some-root

  context: 
      principle: some-principle-root
      person: some-person-root

  prep:
    - name: codes 
      domain: challenge 
      state: 
        root: some-root 
        code: "123456"
        expires: "30000-12-31T00:00:00+00:00"

  targets:
    - name: contexts
      domain: person
      context: view-store
    - name: codes
      domain: challenge
      context: view-store
    - action: issue
      domain: challenge
      context: command-handler
    - name: phones
      domain: person
      context: view-store
    - name: permissions
      domain: principle
      context: view-store